{"ast":null,"code":"import _regeneratorRuntime from\"/home/mauro/Escritorio/React/react-tasks/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mauro/Escritorio/React/react-tasks/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/mauro/Escritorio/React/react-tasks/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useReducer}from'react';import authContext from'./authContext';import authReducer from'./authReducer';import axiosClient from'../../config/axios';import authToken from'../../config/authToken';import{SUCCESSFULL_LOGIN,SUCCESSFULL_SIGNIN,FAILED_LOGIN,FAILED_SIGNIN,GET_USER,LOG_OUT}from'../../types';var AuthState=function AuthState(props){var initialState={token:localStorage.getItem('token'),auth:null,user:null,msg:null,loading:true};var _useReducer=useReducer(authReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var signInUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var response,alert;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axiosClient.post('/api/users',data);case 3:response=_context.sent;dispatch({type:SUCCESSFULL_SIGNIN,payload:response.data});getAuthUser();_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);alert={msg:_context.t0.response.data.msg,category:'alerta-error'};dispatch({type:FAILED_SIGNIN,payload:alert});case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function signInUser(_x){return _ref.apply(this,arguments);};}();var getAuthUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var token,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:token=localStorage.getItem('token');if(token){authToken(token);}_context2.prev=2;_context2.next=5;return axiosClient.get('/api/auth');case 5:response=_context2.sent;dispatch({type:GET_USER,payload:response.data.user});_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](2);dispatch({type:FAILED_LOGIN});case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[2,9]]);}));return function getAuthUser(){return _ref2.apply(this,arguments);};}();var logIn=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(data){var response,alert;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axiosClient.post('/api/auth',data);case 3:response=_context3.sent;console.log(response);dispatch({type:SUCCESSFULL_LOGIN,payload:response.data});getAuthUser();_context3.next=14;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0.response.data.msg);alert={msg:_context3.t0.response.data.msg,category:'alerta-error'};dispatch({type:FAILED_LOGIN,payload:alert});case 14:case\"end\":return _context3.stop();}}},_callee3,null,[[0,9]]);}));return function logIn(_x2){return _ref3.apply(this,arguments);};}();var logOut=function logOut(){dispatch({type:LOG_OUT});};return/*#__PURE__*/React.createElement(authContext.Provider,{value:{token:state.token,auth:state.auth,user:state.user,msg:state.msg,loading:state.loading,signInUser:signInUser,logIn:logIn,getAuthUser:getAuthUser,logOut:logOut}},props.children);};export default AuthState;","map":{"version":3,"sources":["/home/mauro/Escritorio/React/react-tasks/client/src/context/auth/authState.js"],"names":["React","useReducer","authContext","authReducer","axiosClient","authToken","SUCCESSFULL_LOGIN","SUCCESSFULL_SIGNIN","FAILED_LOGIN","FAILED_SIGNIN","GET_USER","LOG_OUT","AuthState","props","initialState","token","localStorage","getItem","auth","user","msg","loading","state","dispatch","signInUser","data","post","response","type","payload","getAuthUser","alert","category","get","logIn","console","log","logOut","children"],"mappings":"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","sourcesContent":["import React, {useReducer} from 'react';\nimport authContext from './authContext';\nimport authReducer from './authReducer';\nimport axiosClient from '../../config/axios';\nimport authToken from '../../config/authToken';\n\nimport { \n    SUCCESSFULL_LOGIN,\n    SUCCESSFULL_SIGNIN,\n    FAILED_LOGIN,\n    FAILED_SIGNIN,\n    GET_USER,\n    LOG_OUT\n } from '../../types';\n\n const AuthState = props => {\n\n    const initialState = {\n        token: localStorage.getItem('token'),\n        auth: null,\n        user: null,\n        msg: null,\n        loading: true\n    }\n\n    const [state, dispatch] = useReducer(authReducer, initialState);\n\n    const signInUser = async data => {\n        try {\n            const response = await axiosClient.post('/api/users', data);\n            dispatch({\n                type: SUCCESSFULL_SIGNIN,\n                payload: response.data\n            })\n\n            getAuthUser();\n        } catch (error) {\n            const alert = {\n                msg: error.response.data.msg,\n                category: 'alerta-error'\n            }\n            dispatch({\n                type: FAILED_SIGNIN,\n                payload: alert\n            })\n        }\n    }\n\n    const getAuthUser = async () => {\n        const token = localStorage.getItem('token');\n        if(token){\n            authToken(token);\n        }\n        try {\n            const response = await axiosClient.get('/api/auth');\n            dispatch({\n                type: GET_USER,\n                payload: response.data.user\n            });\n        } catch (error) {\n            dispatch({\n                type: FAILED_LOGIN\n            })\n        }\n    }\n\n    const logIn = async data => {\n        try {\n            const response = await axiosClient.post('/api/auth', data);\n            console.log(response);\n            dispatch({\n                type: SUCCESSFULL_LOGIN,\n                payload: response.data\n            })\n            getAuthUser();\n        } catch (error) {\n            console.log(error.response.data.msg);\n            const alert = {\n                msg: error.response.data.msg,\n                category: 'alerta-error'\n            }\n            dispatch({\n                type: FAILED_LOGIN,\n                payload: alert\n            })\n        }\n    }\n\n    const logOut = () => {\n        dispatch({\n            type: LOG_OUT\n        })\n    }\n    \n\n    return (\n        <authContext.Provider\n            value={{\n                token: state.token,\n                auth: state.auth,\n                user: state.user,\n                msg: state.msg,\n                loading: state.loading,\n                signInUser,\n                logIn,\n                getAuthUser,\n                logOut\n            }}>\n            {props.children}\n        </authContext.Provider>    \n    )\n\n }\n\n export default AuthState;"]},"metadata":{},"sourceType":"module"}